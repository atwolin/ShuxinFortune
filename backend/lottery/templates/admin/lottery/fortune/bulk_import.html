{% extends "admin/base_site.html" %}
{% load i18n static %}

{% block extrahead %}
{{ block.super }}
<style>
    .bulk-import-form {
        max-width: 800px;
        margin: 20px auto;
    }

    .form-row {
        margin-bottom: 20px;
    }

    .form-row label {
        display: block;
        font-weight: bold;
        margin-bottom: 5px;
    }

    .form-row select,
    .form-row textarea {
        width: 100%;
        padding: 8px;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-family: monospace;
    }

    .form-row textarea {
        min-height: 400px;
        line-height: 1.6;
    }

    .help-text {
        color: #666;
        font-size: 12px;
        margin-top: 5px;
    }

    .submit-row {
        margin-top: 20px;
        padding: 10px 0;
        border-top: 1px solid #ddd;
    }

    .button {
        padding: 10px 20px;
        margin-right: 10px;
        border: none;
        border-radius: 4px;
        cursor: pointer;
        font-size: 14px;
    }

    .default {
        background-color: #417690;
        color: white;
    }

    .default:hover {
        background-color: #205067;
    }

    .instructions {
        background-color: #f0f8ff;
        border: 1px solid #b8d4e8;
        border-radius: 4px;
        padding: 15px;
        margin-bottom: 20px;
    }

    .instructions h3 {
        margin-top: 0;
        color: #205067;
    }

    .instructions ul {
        margin: 10px 0;
        padding-left: 20px;
    }

    .instructions li {
        margin: 5px 0;
    }
</style>
{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
    &rsaquo; <a href="{% url 'admin:lottery_fortune_changelist' %}">{% trans 'Fortunes' %}</a>
    &rsaquo; {% trans 'æ‰¹é‡å°å…¥ç±¤è©©' %}
</div>
{% endblock %}

{% block content %}
<div class="bulk-import-form">
    <div class="instructions">
        <h3>ğŸ“ ä½¿ç”¨èªªæ˜</h3>
        <ul>
            <li><strong>æ¯è¡Œä¸€æ¢ç±¤è©©</strong>ï¼šå°‡ç±¤è©©è²¼åˆ°ä¸‹æ–¹æ–‡æœ¬æ¡†ï¼Œæ¯è¡Œä¸€æ¢</li>
            <li><strong>è‡ªå‹•éæ¿¾ç©ºè¡Œ</strong>ï¼šç³»çµ±æœƒè‡ªå‹•å¿½ç•¥ç©ºç™½è¡Œ</li>
            <li><strong>é¸æ“‡åˆ†é¡</strong>ï¼šæ‰€æœ‰å°å…¥çš„ç±¤è©©å°‡æ­¸é¡åˆ°æ‚¨é¸æ“‡çš„åˆ†é¡ä¸­</li>
            <li><strong>æ‰¹é‡å»ºç«‹</strong>ï¼šé»æ“Šã€Œé–‹å§‹å°å…¥ã€å¾Œï¼Œç³»çµ±æœƒä¸€æ¬¡æ€§å»ºç«‹æ‰€æœ‰ç±¤è©©</li>
        </ul>
    </div>

    <form method="post">
        {% csrf_token %}

        <div class="form-row">
            <label for="category">ç±¤è©©åˆ†é¡ <span style="color: red;">*</span></label>
            <select name="category" id="category" required>
                <option value="">è«‹é¸æ“‡åˆ†é¡...</option>
                {% for category in categories %}
                <option value="{{ category.id }}">{{ category.name }}</option>
                {% endfor %}
            </select>
            <p class="help-text">é¸æ“‡é€™æ‰¹ç±¤è©©æ‰€å±¬çš„åˆ†é¡</p>
        </div>

        <div class="form-row">
            <label for="fortunes_text">ç±¤è©©å…§å®¹ <span style="color: red;">*</span></label>
            <textarea name="fortunes_text" id="fortunes_text" required placeholder="è«‹è²¼ä¸Šç±¤è©©ï¼Œæ¯è¡Œä¸€æ¢...

ç¯„ä¾‹ï¼š
ä½ å·²ç¶“æ¯”æ˜¨å¤©æ›´å‰é€²äº†ï¼Œå°±ç®—ä½ è‡ªå·±æ²’æœ‰ç™¼ç¾ï¼Œé‚£äº›ç´¯ç©éƒ½æ˜¯çœŸå¯¦å­˜åœ¨çš„ã€‚
ä½ æœƒç·Šå¼µï¼Œæ˜¯å› ç‚ºä½ åœ¨ä¹ï¼Œè€Œåœ¨ä¹æœ¬èº«å°±æ˜¯ä¸€ç¨®å¾ˆçè²´çš„åŠªåŠ›ã€‚
æ”¾å¿ƒï¼Œä½ ä¸æ˜¯ä¸€å€‹äººèµ°åˆ°é€™è£¡çš„ï¼Œä½ èº«é‚Šçš„æ¯å€‹äººéƒ½å’Œä½ ä¸€èµ·åŠªåŠ›è‘—ã€‚"></textarea>
            <p class="help-text">
                æ¯è¡Œä¸€æ¢ç±¤è©©ï¼Œç³»çµ±æœƒè‡ªå‹•éæ¿¾ç©ºç™½è¡Œã€‚
                <span id="line-count" style="color: #417690; font-weight: bold;"></span>
            </p>
        </div>

        <div class="submit-row">
            <input type="submit" value="é–‹å§‹å°å…¥" class="button default">
            <a href="{% url 'admin:lottery_fortune_changelist' %}" class="button">å–æ¶ˆ</a>
        </div>
    </form>
</div>

<script>
    // Count lines in real-time
    document.getElementById('fortunes_text').addEventListener('input', function () {
        const text = this.value.trim();
        const lines = text ? text.split('\n').filter(line => line.trim()).length : 0;
        const countElement = document.getElementById('line-count');
        if (lines > 0) {
            countElement.textContent = `å°‡å°å…¥ ${lines} æ¢ç±¤è©©`;
        } else {
            countElement.textContent = '';
        }
    });
</script>
{% endblock %}
